[32m2022-04-21 07:49:47 -0400[0m - dagster - [34mDEBUG[0m - load_data_to_snowflake - 80e9f72e-9b12-49cc-8145-bd8c7fd6ce1e - 52540 - copy_partition_into_snowflake - LOGS_CAPTURED - Started capturing logs for step: copy_partition_into_snowflake.
[32m2022-04-21 07:49:47 -0400[0m - dagster - [34mDEBUG[0m - load_data_to_snowflake - 80e9f72e-9b12-49cc-8145-bd8c7fd6ce1e - 52540 - copy_partition_into_snowflake - STEP_START - Started execution of step "copy_partition_into_snowflake".
[32m2022-04-21 07:49:47 -0400[0m - dagster - [34mDEBUG[0m - load_data_to_snowflake - 80e9f72e-9b12-49cc-8145-bd8c7fd6ce1e - 52540 - copy_partition_into_snowflake - ASSET_OBSERVATION - DagsterEventType.ASSET_OBSERVATION for step copy_partition_into_snowflake
[32m2022-04-21 07:49:47 -0400[0m - dagster - [34mDEBUG[0m - load_data_to_snowflake - 80e9f72e-9b12-49cc-8145-bd8c7fd6ce1e - 52540 - copy_partition_into_snowflake - LOADED_INPUT - Loaded input "delete_partition_from_snowflake" using input manager "io_manager", from output "result" of step "delete_partition_from_snowflake"
[32m2022-04-21 07:49:47 -0400[0m - dagster - [34mDEBUG[0m - load_data_to_snowflake - 80e9f72e-9b12-49cc-8145-bd8c7fd6ce1e - 52540 - copy_partition_into_snowflake - STEP_INPUT - Got input "delete_partition_from_snowflake" of type "Any". (Type check passed).
[32m2022-04-21 07:49:48 -0400[0m - dagster - [34mINFO[0m - resource:snowflake - 80e9f72e-9b12-49cc-8145-bd8c7fd6ce1e - copy_partition_into_snowflake - Executing query: 
        
        copy into RAW.RAW_NHL_GAME_DATA
        from (
        Select 
                METADATA$FILENAME as file_name,
                date(split_part(split_part(METADATA$FILENAME, '/', 2),'=',2)) as partition_date,
                split_part(split_part(METADATA$FILENAME, '/', 3), '.',1) as game_id,
                $1 as json_extract
                
        from @RAW.RAW_NHL_GAME_DATA
        )
        pattern = '.*partition_date=2022-04-20.*.json'
        force = TRUE;
        
[32m2022-04-21 07:49:53 -0400[0m - dagster - [34mDEBUG[0m - load_data_to_snowflake - 80e9f72e-9b12-49cc-8145-bd8c7fd6ce1e - 52540 - copy_partition_into_snowflake - STEP_OUTPUT - Yielded output "result" of type "Any". (Type check passed).
[32m2022-04-21 07:49:53 -0400[0m - dagster - [34mDEBUG[0m - load_data_to_snowflake - 80e9f72e-9b12-49cc-8145-bd8c7fd6ce1e - 52540 - copy_partition_into_snowflake - ASSET_MATERIALIZATION - Materialized value copy_partition_into_snowflake.
[32m2022-04-21 07:49:53 -0400[0m - dagster - [34mDEBUG[0m - load_data_to_snowflake - 80e9f72e-9b12-49cc-8145-bd8c7fd6ce1e - 52540 - copy_partition_into_snowflake - HANDLED_OUTPUT - Handled output "result" using IO manager "io_manager"
[32m2022-04-21 07:49:53 -0400[0m - dagster - [34mDEBUG[0m - load_data_to_snowflake - 80e9f72e-9b12-49cc-8145-bd8c7fd6ce1e - 52540 - copy_partition_into_snowflake - STEP_SUCCESS - Finished execution of step "copy_partition_into_snowflake" in 6.63s.
