[32m2022-04-20 21:10:17 -0400[0m - dagster - [34mDEBUG[0m - load_data_to_snowflake - 1afaa398-4f84-4dea-9817-109d403a26cd - 46858 - copy_partition_into_snowflake - LOGS_CAPTURED - Started capturing logs for step: copy_partition_into_snowflake.
[32m2022-04-20 21:10:17 -0400[0m - dagster - [34mDEBUG[0m - load_data_to_snowflake - 1afaa398-4f84-4dea-9817-109d403a26cd - 46858 - copy_partition_into_snowflake - STEP_START - Started execution of step "copy_partition_into_snowflake".
[32m2022-04-20 21:10:17 -0400[0m - dagster - [34mDEBUG[0m - load_data_to_snowflake - 1afaa398-4f84-4dea-9817-109d403a26cd - 46858 - copy_partition_into_snowflake - ASSET_OBSERVATION - DagsterEventType.ASSET_OBSERVATION for step copy_partition_into_snowflake
[32m2022-04-20 21:10:17 -0400[0m - dagster - [34mDEBUG[0m - load_data_to_snowflake - 1afaa398-4f84-4dea-9817-109d403a26cd - 46858 - copy_partition_into_snowflake - LOADED_INPUT - Loaded input "delete_partition_from_snowflake" using input manager "io_manager", from output "result" of step "delete_partition_from_snowflake"
[32m2022-04-20 21:10:17 -0400[0m - dagster - [34mDEBUG[0m - load_data_to_snowflake - 1afaa398-4f84-4dea-9817-109d403a26cd - 46858 - copy_partition_into_snowflake - STEP_INPUT - Got input "delete_partition_from_snowflake" of type "Any". (Type check passed).
[32m2022-04-20 21:10:19 -0400[0m - dagster - [34mINFO[0m - resource:snowflake - 1afaa398-4f84-4dea-9817-109d403a26cd - copy_partition_into_snowflake - Executing query: 
        
        copy into RAW.RAW_NHL_GAME_DATA
        from (
        Select 
                METADATA$FILENAME as file_name,
                date(split_part(split_part(METADATA$FILENAME, '/', 2),'=',2)) as partition_date,
                split_part(split_part(METADATA$FILENAME, '/', 3), '.',1) as game_id,
                $1 as json_extract
                
        from @RAW.RAW_NHL_GAME_DATA
        )
        pattern = '.*partition_date=2022-04-19.*.json'
        force = TRUE;
        
[32m2022-04-20 21:10:23 -0400[0m - dagster - [34mDEBUG[0m - load_data_to_snowflake - 1afaa398-4f84-4dea-9817-109d403a26cd - 46858 - copy_partition_into_snowflake - STEP_OUTPUT - Yielded output "result" of type "Any". (Type check passed).
[32m2022-04-20 21:10:23 -0400[0m - dagster - [34mDEBUG[0m - load_data_to_snowflake - 1afaa398-4f84-4dea-9817-109d403a26cd - 46858 - copy_partition_into_snowflake - ASSET_MATERIALIZATION - Materialized value copy_partition_into_snowflake.
[32m2022-04-20 21:10:23 -0400[0m - dagster - [34mDEBUG[0m - load_data_to_snowflake - 1afaa398-4f84-4dea-9817-109d403a26cd - 46858 - copy_partition_into_snowflake - HANDLED_OUTPUT - Handled output "result" using IO manager "io_manager"
[32m2022-04-20 21:10:23 -0400[0m - dagster - [34mDEBUG[0m - load_data_to_snowflake - 1afaa398-4f84-4dea-9817-109d403a26cd - 46858 - copy_partition_into_snowflake - STEP_SUCCESS - Finished execution of step "copy_partition_into_snowflake" in 6.17s.
